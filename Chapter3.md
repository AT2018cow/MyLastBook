# 理念、原则和定律

当我们谈及理念的时候，一般指期望按照某个理想的方式做事，而执行过程中，则有可能因为各种客观因素的限制，导致这种期望无法达成；而原则则不同：原则是必须达成的理念，在执行过程中，需要设立规章制度、流程、工具链等措施，确保原则可以达成。在实际工作中，明确理念和原则的区别至关重要：达成理念，会带来好的结果，应该奖励，不能达成，也不是什么太大的问题，下次再努力即可；遵守原则，是分内之事，违反原则，会带来坏的结果，应该惩罚。当然，结果的好坏，是个相对的概念，与投入的时间、资本、人员等诸多因素有关，某种意义上，一个组织的进步，就是把优秀的理念逐渐变成原则的过程。

在实际工作中，理念可以是感性的和鼓舞人心的，而原则则必须是：

* 措辞明确的：必须明确阐述该怎样做和达到什么样的目标，以作为实际工作的指导方针；
* 现实可达的：必须是在付出一定努力之后可以实现的，制定难以实现的原则，除了不具备指导实践的意义之外，还可能会打击团队士气；
* 可度量的：必须是量化的，实际工作中，不能只说“接口简洁”，还要将简洁的程度加以量化，例如，“接口数量小于m个”、“参数数量小于n个”、等等；
* 可检验的：实际工作中，如果提出原则，那么必须对原则的达成情况进行检验，不能检验达成情况的原则只是空谈；

与原则相关的另一个概念是定律（也称法则），人们经常混淆这两个概念，尤其是在翻译文章中。实际上，原则和定律是两个完全相反的概念，原则是“经过一定努力可以达到的”，定律是“经过再多努力也难以违背的”。定律一般会陈述一种难以违背的现象，也可能是一个假言命题：如果你的状况不幸落入假言命题的前件，那么绝大多情况下，你将面对该假言命题的后件所描述的糟糕结局。

下文我们会介绍一些与微服务开发密切相关的理念、原则和定律。

## 理念

早期的操作系统（如DEC的VMS）进程生成代价昂贵，缺乏灵活易用的进程控制机制，迫使开发者编写怪物般的巨大单体应用，将越来越多的功能和特性塞入其中，久而久之，怪物般的应用像怪物般失控，或者因不堪重负而内部崩溃。Unix操作系统的出现，带来了低价的进程生成能力和简便的进程间通讯机制，使得编写多个功能单一的小程序，并通过管道和过滤器彼此协作、组成一个均衡系统成为可能。随着Unix的流行，这种编程方式成为开发复杂应用的默认方式，以至于时不时的出现这样的笑话：

>Unix新手：“我关闭了音乐播放器，为什么音乐还在响？”
>Unix老手：“你关闭的只是播放器的图形界面，并不是播放器的引擎。”

发生这样的事情，显然是因为播放器的界面和后端的解码器是两个进程，通过进程间通讯机制彼此协作，共同完成一个完整的音乐播放器功能。这种设计很多好处，例如：

1. 开发者可以开发多个不同风格的界面，并且很容易的将一个界面换成另外一个。
1. 开发者可以调用不同的后端解码器，以支持不同的音乐格式，引入新的音乐格式，或者换掉现有的解码器，也非常简单。
1. 社区已经有很多成熟的解码器，拿来用即可，甚至不需要重新编译。

当然，一个设计良好的音乐播放器，在图形界面被关闭的时候，是可以发消息通知后端的解码器将自己关闭的。但是即使不是这样，在Unix世界生存的人们也对其习以为常，可见这种开发模式的普遍性。

可惜多年以后，Java语言开始流行，JVM屏蔽了底层操作系统的差异，开发者在大多数时间只要和JVM打交道，即可完成手头的工作，操作系统变得无足轻重，操作系统的优秀机制对软件开发带来的便利性也荡然无存。

JVM没有提供类似Unix的进程管理和通讯能力，使得开发者再次倾向于编写怪物般的巨大单体应用，在Java应用服务器出现之后，这种情况没有得到改观，反而愈演愈烈，将多个应用运行在同一个应用服务器之上，形成了无比巨大的单一Java进程，一个微小的Bug都可能造成进程退出，而代码错综复杂的巨大单体应用，出现这种Bug的概率非常之高。

## 原则


## 定律

### 侯世达定律

道格拉斯·理查·郝夫斯台特（Douglas Richard Hofstadter），美国印第安纳大学文理学院认知科学教授，主要研究领域包括意识、类比、艺术创造、文学翻译以及数学和物理学探索，侯世达是他的中文名。这位看起来和软件行业关系不大的学者（他本人也说“对计算机没有兴趣”），其普利策奖著作《哥德尔、埃舍尔、巴赫》中的一句格言却在软件行业广为流传，这句格言被称为侯世达定律（Hofstadter's law）：

>做事所花费的时间总是比你预期的要长，即使你的预期中考虑了侯世达定律。

侯世达定律指出完成复杂任务需要花费的时间总是很难预计。这个定律经常被软件开发人员提起，特别是在进行项目计划的讨论时。定律使用自指方式（或者说是递归）表述了即使充分意识到了任务的复杂性，仍然难以准确预计完成任务所需时间的窘境。

即使使用微服务模式开发你的应用，侯世达定律依然有效，因为在评估开发所需时间的时候，你已经将微服务模式带来的效率提高考虑在内了，不是吗？

### 90-90定律

90-90定律（ninety-ninety rule）是软件行业又一个有名的定律，源自贝尔实验室专家汤姆·卡吉尔（Tom Cargill）的一句玩笑话：

>前90%的代码要花费90%的开发时间，剩余的10%的代码要再花费90%的开发时间。

合计180%的时间总量用看似荒诞的方式指出了软件项目的一个顽疾——项目完成时间常常大幅超出预期。这个定律体现了在评估软件项目完成时间的时候，对简单任务和困难任务的时间分配太过粗糙的问题，也揭示了很多项目被迫延期的原因：最后10%的工作的难度，是前90%工作的难度的9倍（如果不是10倍的话）。

### 布鲁克斯定律

是的，这个布鲁克斯就是IBM System/360系统之父和软件工程著作《人月神华》的作者弗雷德·布鲁克斯（Fred Brooks）。布鲁克斯定律（Brook's Law）的内容是：

>给一个延期的项目增加人手会使它拖得更久。

弗雷德·布鲁克斯在《人月神话》中提出了这一定律，并对其成立的原因做出了如下解释：

1. 新加入项目的人员需要学习一段时间才会有产出，教会他们反而会占用团队中老成员的时间。
1. 人员数量增加，沟通成本也会增加，最糟糕的情况下是指数级增加。
1. 任务的有限可分性：一些任务不可分割，增加人手不能使任务完成的更快。

那项目延期了怎么办？弗雷德·布鲁克斯给出的办法是：降低项目目标。

### 埃托雷观察

埃托雷观察（Ettorre's Observation）的内容是：

>另外一条路看起来会走得更快。

软件项目中存在大量的路径选择问题，大到选择一个技术方向，小到选择一个具体问题的解决方式，当我们在已选的路径上遇到障碍时，经常会觉得之前如果选择另一条路径，事情会更加顺利。这种想法经常会导致个人的犹豫不决和团队成员之间的不信任，最终影响项目的整体进度。然而另一条路径很可能只是看起来更加顺利而已，因为你在实践当前路径，对当前路径中会遇到什么困难有着更多的了解，而另一条路径仅存于你的想象之中，你“幻想”它好的一面，却不了解它坏的一面。如果你真的切换到另一条路径，八成你又会觉得之前那条路径会更加顺利，这就是“埃托雷观察”，永远的“另外一条路看起来会走得更快”。

所以，在软件项目中，做路径选择的时候要充分验证，一旦确定路径，就不要因为遇到的困难而犹豫不决。

### 康威定律




